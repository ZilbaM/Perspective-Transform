var t=require("react");function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=/*#__PURE__*/e(t);function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(null,arguments)}module.exports=function(e){var o=e.children,i=t.useRef(null),u=t.useState({topLeft:{x:0,y:0},topRight:{x:100,y:0},bottomRight:{x:100,y:100},bottomLeft:{x:0,y:100}}),f=u[0],a=u[1],c=t.useState(""),l=c[0],v=c[1],d=t.useState(!1),s=d[0],h=d[1];return t.useLayoutEffect(function(){if(i.current){var t=i.current.getBoundingClientRect();t.width>0&&t.height>0&&a({topLeft:{x:0,y:0},topRight:{x:t.width,y:0},bottomRight:{x:t.width,y:t.height},bottomLeft:{x:0,y:t.height}})}},[o]),t.useLayoutEffect(function(){if(i.current){var t=i.current.getBoundingClientRect();if(0===t.width||0===t.height)return;var e=function(t,e){function n(t,e,n,r){var o=[t.x,e.x,n.x,t.y,e.y,n.y,1,1,1],i=function(t,e){var n=t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6]);if(0===n)return null;var r=1/n,o=[t[4]*t[8]-t[5]*t[7],t[2]*t[7]-t[1]*t[8],t[1]*t[5]-t[2]*t[4],t[5]*t[6]-t[3]*t[8],t[0]*t[8]-t[2]*t[6],t[2]*t[3]-t[0]*t[5],t[3]*t[7]-t[4]*t[6],t[1]*t[6]-t[0]*t[7],t[0]*t[4]-t[1]*t[3]].map(function(t){return t*r});return[o[0]*e[0]+o[1]*e[1]+o[2]*e[2],o[3]*e[0]+o[4]*e[1]+o[5]*e[2],o[6]*e[0]+o[7]*e[1]+o[8]*e[2]]}(o,[r.x,r.y,1]);return null===i?null:[o[0]*i[0],o[1]*i[1],o[2]*i[2],o[3]*i[0],o[4]*i[1],o[5]*i[2],o[6]*i[0],o[7]*i[1],o[8]*i[2]]}var r=n(t[0],t[1],t[2],t[3]),o=n(e[0],e[1],e[2],e[3]);if(null===r||null===o)return"";for(var i,u=function(t,e){for(var n=[],r=0;r<3;r+=1)for(var o=0;o<3;o+=1){for(var i=0,u=0;u<3;u+=1)i+=t[3*r+u]*e[3*u+o];n[3*r+o]=i}return n}(o,[(i=r)[4]*i[8]-i[5]*i[7],i[2]*i[7]-i[1]*i[8],i[1]*i[5]-i[2]*i[4],i[5]*i[6]-i[3]*i[8],i[0]*i[8]-i[2]*i[6],i[2]*i[3]-i[0]*i[5],i[3]*i[7]-i[4]*i[6],i[1]*i[6]-i[0]*i[7],i[0]*i[4]-i[1]*i[3]]),f=0;f<u.length;f+=1)u[f]/=u[8];return"matrix3d("+[u[0],u[3],0,u[6],u[1],u[4],0,u[7],0,0,1,0,u[2],u[5],0,u[8]].join(",")+")"}([{x:0,y:0},{x:t.width,y:0},{x:t.width,y:t.height},{x:0,y:t.height}],[f.topLeft,f.topRight,f.bottomRight,f.bottomLeft]);v(e)}},[f]),t.useEffect(function(){var t=function(t){!t.shiftKey||"p"!==t.key&&"P"!==t.key||h(function(t){return!t})};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}},[]),/*#__PURE__*/n.default.createElement("div",{ref:i,className:"perspective-container"},/*#__PURE__*/n.default.createElement("div",{style:{transform:l,transformOrigin:"0 0",width:"100%",height:"100%"}},o),s&&Object.entries(f).map(function(t){var e=t[0],o=t[1];/*#__PURE__*/return n.default.createElement("div",{key:e,className:"control-point",style:{left:o.x,top:o.y},onMouseDown:function(t){return function(t,e){t.preventDefault(),t.stopPropagation();var n=function(t){if(i.current){var n=i.current.getBoundingClientRect(),o=t.clientX-n.left,u=t.clientY-n.top;a(function(t){var n;return r({},t,((n={})[e]={x:o,y:u},n))})}},o=function(){document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)}(t,e)}})}))};
//# sourceMappingURL=index.cjs.map
