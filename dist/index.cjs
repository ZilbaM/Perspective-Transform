var t=require("react"),e=require("styled-components");function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r,o,i=/*#__PURE__*/n(t),u=/*#__PURE__*/n(e);function f(){return f=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},f.apply(null,arguments)}function a(t,e){return e||(e=t.slice(0)),t.raw=e,t}var c=u.default.div(r||(r=a(["\n  width: fit-content;\n  position: relative;\n"]))),l=u.default.div(o||(o=a(["\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  background-color: red;\n  border-radius: 50%;\n  cursor: pointer;\n  transform: translate(-50%, -50%);\n"])));module.exports=function(e){var n=e.children,r=t.useRef(null),o=t.useState({topLeft:{x:0,y:0},topRight:{x:100,y:0},bottomRight:{x:100,y:100},bottomLeft:{x:0,y:100}}),u=o[0],a=o[1],d=t.useState(""),s=d[0],v=d[1],h=t.useState(!1),y=h[0],m=h[1];return t.useLayoutEffect(function(){if(r.current){var t=r.current.getBoundingClientRect();t.width>0&&t.height>0&&a({topLeft:{x:0,y:0},topRight:{x:t.width,y:0},bottomRight:{x:t.width,y:t.height},bottomLeft:{x:0,y:t.height}})}},[n]),t.useLayoutEffect(function(){if(r.current){var t=r.current.getBoundingClientRect();if(0===t.width||0===t.height)return;var e=function(t,e){function n(t,e,n,r){var o=[t.x,e.x,n.x,t.y,e.y,n.y,1,1,1],i=function(t,e){var n=t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6]);if(0===n)return null;var r=1/n,o=[t[4]*t[8]-t[5]*t[7],t[2]*t[7]-t[1]*t[8],t[1]*t[5]-t[2]*t[4],t[5]*t[6]-t[3]*t[8],t[0]*t[8]-t[2]*t[6],t[2]*t[3]-t[0]*t[5],t[3]*t[7]-t[4]*t[6],t[1]*t[6]-t[0]*t[7],t[0]*t[4]-t[1]*t[3]].map(function(t){return t*r});return[o[0]*e[0]+o[1]*e[1]+o[2]*e[2],o[3]*e[0]+o[4]*e[1]+o[5]*e[2],o[6]*e[0]+o[7]*e[1]+o[8]*e[2]]}(o,[r.x,r.y,1]);return null===i?null:[o[0]*i[0],o[1]*i[1],o[2]*i[2],o[3]*i[0],o[4]*i[1],o[5]*i[2],o[6]*i[0],o[7]*i[1],o[8]*i[2]]}var r=n(t[0],t[1],t[2],t[3]),o=n(e[0],e[1],e[2],e[3]);if(null===r||null===o)return"";for(var i,u=function(t,e){for(var n=[],r=0;r<3;r+=1)for(var o=0;o<3;o+=1){for(var i=0,u=0;u<3;u+=1)i+=t[3*r+u]*e[3*u+o];n[3*r+o]=i}return n}(o,[(i=r)[4]*i[8]-i[5]*i[7],i[2]*i[7]-i[1]*i[8],i[1]*i[5]-i[2]*i[4],i[5]*i[6]-i[3]*i[8],i[0]*i[8]-i[2]*i[6],i[2]*i[3]-i[0]*i[5],i[3]*i[7]-i[4]*i[6],i[1]*i[6]-i[0]*i[7],i[0]*i[4]-i[1]*i[3]]),f=0;f<u.length;f+=1)u[f]/=u[8];return"matrix3d("+[u[0],u[3],0,u[6],u[1],u[4],0,u[7],0,0,1,0,u[2],u[5],0,u[8]].join(",")+")"}([{x:0,y:0},{x:t.width,y:0},{x:t.width,y:t.height},{x:0,y:t.height}],[u.topLeft,u.topRight,u.bottomRight,u.bottomLeft]);v(e)}},[u]),t.useEffect(function(){var t=function(t){!t.shiftKey||"p"!==t.key&&"P"!==t.key||m(function(t){return!t})};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}},[]),/*#__PURE__*/i.default.createElement(c,{ref:r},/*#__PURE__*/i.default.createElement("div",{style:{transform:s,transformOrigin:"0 0",width:"100%",height:"100%"}},n),y&&Object.entries(u).map(function(t){var e=t[0],n=t[1];/*#__PURE__*/return i.default.createElement(l,{key:e,style:{left:n.x,top:n.y},onMouseDown:function(t){return function(t,e){t.preventDefault(),t.stopPropagation();var n=function(t){if(r.current){var n=r.current.getBoundingClientRect(),o=t.clientX-n.left,i=t.clientY-n.top;a(function(t){var n;return f({},t,((n={})[e]={x:o,y:i},n))})}},o=function(){document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)}(t,e)}})}))};
//# sourceMappingURL=index.cjs.map
