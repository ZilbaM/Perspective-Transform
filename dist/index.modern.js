import{useRef as t,useState as e,useLayoutEffect as n,useEffect as o}from"react";import r from"styled-components";function i(){return i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},i.apply(null,arguments)}let u,c,s=t=>t;const l=r.div(u||(u=s`
  width: fit-content;
  position: relative;
`)),d=r.div(c||(c=s`
  position: absolute;
  width: 10px;
  height: 10px;
  background-color: red;
  border-radius: 50%;
  cursor: pointer;
  transform: translate(-50%, -50%);
`));function f({children:r}){const u=t(null),[c,s]=e({topLeft:{x:0,y:0},topRight:{x:100,y:0},bottomRight:{x:100,y:100},bottomLeft:{x:0,y:100}}),[f,a]=e(""),[m,y]=e(!1);return n(()=>{if(u.current){const t=u.current.getBoundingClientRect();t.width>0&&t.height>0&&s({topLeft:{x:0,y:0},topRight:{x:t.width,y:0},bottomRight:{x:t.width,y:t.height},bottomLeft:{x:0,y:t.height}})}},[r]),n(()=>{if(u.current){const t=u.current.getBoundingClientRect();if(0===t.width||0===t.height)return;const e=function(t,e){function n(t,e,n,o){const r=[t.x,e.x,n.x,t.y,e.y,n.y,1,1,1],i=function(t,e){const n=t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6]);if(0===n)return null;const o=1/n,r=[t[4]*t[8]-t[5]*t[7],t[2]*t[7]-t[1]*t[8],t[1]*t[5]-t[2]*t[4],t[5]*t[6]-t[3]*t[8],t[0]*t[8]-t[2]*t[6],t[2]*t[3]-t[0]*t[5],t[3]*t[7]-t[4]*t[6],t[1]*t[6]-t[0]*t[7],t[0]*t[4]-t[1]*t[3]].map(t=>t*o);return[r[0]*e[0]+r[1]*e[1]+r[2]*e[2],r[3]*e[0]+r[4]*e[1]+r[5]*e[2],r[6]*e[0]+r[7]*e[1]+r[8]*e[2]]}(r,[o.x,o.y,1]);return null===i?null:[r[0]*i[0],r[1]*i[1],r[2]*i[2],r[3]*i[0],r[4]*i[1],r[5]*i[2],r[6]*i[0],r[7]*i[1],r[8]*i[2]]}const o=n(t[0],t[1],t[2],t[3]),r=n(e[0],e[1],e[2],e[3]);if(null===o||null===r)return"";const i=function(t,e){const n=[];for(let o=0;o<3;o+=1)for(let r=0;r<3;r+=1){let i=0;for(let n=0;n<3;n+=1)i+=t[3*o+n]*e[3*n+r];n[3*o+r]=i}return n}(r,[(u=o)[4]*u[8]-u[5]*u[7],u[2]*u[7]-u[1]*u[8],u[1]*u[5]-u[2]*u[4],u[5]*u[6]-u[3]*u[8],u[0]*u[8]-u[2]*u[6],u[2]*u[3]-u[0]*u[5],u[3]*u[7]-u[4]*u[6],u[1]*u[6]-u[0]*u[7],u[0]*u[4]-u[1]*u[3]]);var u;for(let t=0;t<i.length;t+=1)i[t]/=i[8];return`matrix3d(${[i[0],i[3],0,i[6],i[1],i[4],0,i[7],0,0,1,0,i[2],i[5],0,i[8]].join(",")})`}([{x:0,y:0},{x:t.width,y:0},{x:t.width,y:t.height},{x:0,y:t.height}],[c.topLeft,c.topRight,c.bottomRight,c.bottomLeft]);a(e)}},[c]),o(()=>{const t=t=>{!t.shiftKey||"p"!==t.key&&"P"!==t.key||y(t=>!t)};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[]),h(l,{ref:u},h("div",{style:{transform:f,transformOrigin:"0 0",width:"100%",height:"100%"}},r),m&&Object.entries(c).map(([t,{x:e,y:n}])=>h(d,{key:t,style:{left:e,top:n},onMouseDown:e=>((t,e)=>{t.preventDefault(),t.stopPropagation();const n=t=>{if(u.current){const n=u.current.getBoundingClientRect(),o=t.clientX-n.left,r=t.clientY-n.top;s(t=>i({},t,{[e]:{x:o,y:r}}))}},o=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)})(e,t)})))}export{f as default};
//# sourceMappingURL=index.modern.js.map
