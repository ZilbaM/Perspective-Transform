import t,{useRef as n,useState as e,useLayoutEffect as r,useEffect as o}from"react";import i from"styled-components";function u(){return u=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)({}).hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},u.apply(null,arguments)}function a(t,n){return n||(n=t.slice(0)),t.raw=n,t}var c,f,l=i.div(c||(c=a(["\n  width: fit-content;\n  position: relative;\n"]))),d=i.div(f||(f=a(["\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  background-color: red;\n  border-radius: 50%;\n  cursor: pointer;\n  transform: translate(-50%, -50%);\n"])));function v(i){var a=i.children,c=n(null),f=e({topLeft:{x:0,y:0},topRight:{x:100,y:0},bottomRight:{x:100,y:100},bottomLeft:{x:0,y:100}}),v=f[0],h=f[1],s=e(""),m=s[0],y=s[1],p=e(!1),g=p[0],x=p[1];return r(function(){if(c.current){var t=c.current.getBoundingClientRect();t.width>0&&t.height>0&&h({topLeft:{x:0,y:0},topRight:{x:t.width,y:0},bottomRight:{x:t.width,y:t.height},bottomLeft:{x:0,y:t.height}})}},[a]),r(function(){if(c.current){var t=c.current.getBoundingClientRect();if(0===t.width||0===t.height)return;var n=function(t,n){function e(t,n,e,r){var o=[t.x,n.x,e.x,t.y,n.y,e.y,1,1,1],i=function(t,n){var e=t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6]);if(0===e)return null;var r=1/e,o=[t[4]*t[8]-t[5]*t[7],t[2]*t[7]-t[1]*t[8],t[1]*t[5]-t[2]*t[4],t[5]*t[6]-t[3]*t[8],t[0]*t[8]-t[2]*t[6],t[2]*t[3]-t[0]*t[5],t[3]*t[7]-t[4]*t[6],t[1]*t[6]-t[0]*t[7],t[0]*t[4]-t[1]*t[3]].map(function(t){return t*r});return[o[0]*n[0]+o[1]*n[1]+o[2]*n[2],o[3]*n[0]+o[4]*n[1]+o[5]*n[2],o[6]*n[0]+o[7]*n[1]+o[8]*n[2]]}(o,[r.x,r.y,1]);return null===i?null:[o[0]*i[0],o[1]*i[1],o[2]*i[2],o[3]*i[0],o[4]*i[1],o[5]*i[2],o[6]*i[0],o[7]*i[1],o[8]*i[2]]}var r=e(t[0],t[1],t[2],t[3]),o=e(n[0],n[1],n[2],n[3]);if(null===r||null===o)return"";for(var i,u=function(t,n){for(var e=[],r=0;r<3;r+=1)for(var o=0;o<3;o+=1){for(var i=0,u=0;u<3;u+=1)i+=t[3*r+u]*n[3*u+o];e[3*r+o]=i}return e}(o,[(i=r)[4]*i[8]-i[5]*i[7],i[2]*i[7]-i[1]*i[8],i[1]*i[5]-i[2]*i[4],i[5]*i[6]-i[3]*i[8],i[0]*i[8]-i[2]*i[6],i[2]*i[3]-i[0]*i[5],i[3]*i[7]-i[4]*i[6],i[1]*i[6]-i[0]*i[7],i[0]*i[4]-i[1]*i[3]]),a=0;a<u.length;a+=1)u[a]/=u[8];return"matrix3d("+[u[0],u[3],0,u[6],u[1],u[4],0,u[7],0,0,1,0,u[2],u[5],0,u[8]].join(",")+")"}([{x:0,y:0},{x:t.width,y:0},{x:t.width,y:t.height},{x:0,y:t.height}],[v.topLeft,v.topRight,v.bottomRight,v.bottomLeft]);y(n)}},[v]),o(function(){var t=function(t){!t.shiftKey||"p"!==t.key&&"P"!==t.key||x(function(t){return!t})};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}},[]),/*#__PURE__*/t.createElement(l,{ref:c},/*#__PURE__*/t.createElement("div",{style:{transform:m,transformOrigin:"0 0",width:"100%",height:"100%"}},a),g&&Object.entries(v).map(function(n){var e=n[0],r=n[1];/*#__PURE__*/return t.createElement(d,{key:e,style:{left:r.x,top:r.y},onMouseDown:function(t){return function(t,n){t.preventDefault(),t.stopPropagation();var e=function(t){if(c.current){var e=c.current.getBoundingClientRect(),r=t.clientX-e.left,o=t.clientY-e.top;h(function(t){var e;return u({},t,((e={})[n]={x:r,y:o},e))})}},r=function(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",r)}(t,e)}})}))}export{v as default};
//# sourceMappingURL=index.module.js.map
