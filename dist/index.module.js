import t,{useRef as e,useState as n,useLayoutEffect as r,useEffect as o}from"react";function i(){return i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i.apply(null,arguments)}function u(u){var c=u.children,a=e(null),f=n({topLeft:{x:0,y:0},topRight:{x:100,y:0},bottomRight:{x:100,y:100},bottomLeft:{x:0,y:100}}),l=f[0],v=f[1],h=n(""),d=h[0],m=h[1],s=n(!1),y=s[0],g=s[1];return r(function(){if(a.current){var t=a.current.getBoundingClientRect();t.width>0&&t.height>0&&v({topLeft:{x:0,y:0},topRight:{x:t.width,y:0},bottomRight:{x:t.width,y:t.height},bottomLeft:{x:0,y:t.height}})}},[c]),r(function(){if(a.current){var t=a.current.getBoundingClientRect();if(0===t.width||0===t.height)return;var e=function(t,e){function n(t,e,n,r){var o=[t.x,e.x,n.x,t.y,e.y,n.y,1,1,1],i=function(t,e){var n=t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6]);if(0===n)return null;var r=1/n,o=[t[4]*t[8]-t[5]*t[7],t[2]*t[7]-t[1]*t[8],t[1]*t[5]-t[2]*t[4],t[5]*t[6]-t[3]*t[8],t[0]*t[8]-t[2]*t[6],t[2]*t[3]-t[0]*t[5],t[3]*t[7]-t[4]*t[6],t[1]*t[6]-t[0]*t[7],t[0]*t[4]-t[1]*t[3]].map(function(t){return t*r});return[o[0]*e[0]+o[1]*e[1]+o[2]*e[2],o[3]*e[0]+o[4]*e[1]+o[5]*e[2],o[6]*e[0]+o[7]*e[1]+o[8]*e[2]]}(o,[r.x,r.y,1]);return null===i?null:[o[0]*i[0],o[1]*i[1],o[2]*i[2],o[3]*i[0],o[4]*i[1],o[5]*i[2],o[6]*i[0],o[7]*i[1],o[8]*i[2]]}var r=n(t[0],t[1],t[2],t[3]),o=n(e[0],e[1],e[2],e[3]);if(null===r||null===o)return"";for(var i,u=function(t,e){for(var n=[],r=0;r<3;r+=1)for(var o=0;o<3;o+=1){for(var i=0,u=0;u<3;u+=1)i+=t[3*r+u]*e[3*u+o];n[3*r+o]=i}return n}(o,[(i=r)[4]*i[8]-i[5]*i[7],i[2]*i[7]-i[1]*i[8],i[1]*i[5]-i[2]*i[4],i[5]*i[6]-i[3]*i[8],i[0]*i[8]-i[2]*i[6],i[2]*i[3]-i[0]*i[5],i[3]*i[7]-i[4]*i[6],i[1]*i[6]-i[0]*i[7],i[0]*i[4]-i[1]*i[3]]),c=0;c<u.length;c+=1)u[c]/=u[8];return"matrix3d("+[u[0],u[3],0,u[6],u[1],u[4],0,u[7],0,0,1,0,u[2],u[5],0,u[8]].join(",")+")"}([{x:0,y:0},{x:t.width,y:0},{x:t.width,y:t.height},{x:0,y:t.height}],[l.topLeft,l.topRight,l.bottomRight,l.bottomLeft]);m(e)}},[l]),o(function(){var t=function(t){!t.shiftKey||"p"!==t.key&&"P"!==t.key||g(function(t){return!t})};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}},[]),/*#__PURE__*/t.createElement("div",{ref:a,className:"perspective-container"},/*#__PURE__*/t.createElement("div",{style:{transform:d,transformOrigin:"0 0",width:"100%",height:"100%"}},c),y&&Object.entries(l).map(function(e){var n=e[0],r=e[1];/*#__PURE__*/return t.createElement("div",{key:n,className:"control-point",style:{left:r.x,top:r.y},onMouseDown:function(t){return function(t,e){t.preventDefault(),t.stopPropagation();var n=function(t){if(a.current){var n=a.current.getBoundingClientRect(),r=t.clientX-n.left,o=t.clientY-n.top;v(function(t){var n;return i({},t,((n={})[e]={x:r,y:o},n))})}},r=function(){document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",r)}(t,n)}})}))}export{u as default};
//# sourceMappingURL=index.module.js.map
